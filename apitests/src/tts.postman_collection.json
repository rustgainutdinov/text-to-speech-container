{
	"info": {
		"_postman_id": "ee0995f4-7913-4ec6-840a-af1889a9381a",
		"name": "Text to speech",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Balance service",
			"item": [
				{
					"name": "shouldCreateBalance",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"async function run() {",
									"    await new Promise(done => setTimeout(() => done(), 10000));",
									"}",
									"run();",
									"function uuidv4() {",
									"    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {",
									"        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);",
									"        return v.toString(16);",
									"    });",
									"}",
									"pm.environment.set(\"currentBalanceUserID\", uuidv4())"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"userID\":\"{{currentBalanceUserID}}\"}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}{{balanceServicePort}}/api/v1/balance/create",
							"host": [
								"{{host}}{{balanceServicePort}}"
							],
							"path": [
								"api",
								"v1",
								"balance",
								"create"
							]
						}
					},
					"response": []
				},
				{
					"name": "shouldTopUpBalance",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"pm.sendRequest(pm.environment.get(\"host\") + pm.environment.get(\"balanceServicePort\") + \"/api/v1/balance/canWriteOff?score=100&userID=\" + pm.environment.get(\"currentBalanceUserID\"), function (err, response) {",
									"    let res = response.json();",
									"    console.log(response.status);",
									"    pm.test('It should be possible to write off 100 score', function () {",
									"        pm.expect(response.status).to.eql(\"OK\");",
									"        pm.expect(res.result).to.eql(true);",
									"    });",
									"});",
									"pm.sendRequest(pm.environment.get(\"host\") + pm.environment.get(\"balanceServicePort\") + \"/api/v1/balance/canWriteOff?score=101&userID=\" + pm.environment.get(\"currentBalanceUserID\"), function (err, response) {",
									"    let res = response.json();",
									"    console.log(response.status);",
									"    pm.test('It should be impossible to write off 101 score', function () {",
									"        pm.expect(response.status).to.eql(\"OK\");",
									"        pm.expect(res.result).to.eql(false);",
									"    });",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"userID\": \"{{currentBalanceUserID}}\",\n    \"score\": 100\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}{{balanceServicePort}}/api/v1/balance/topUp",
							"host": [
								"{{host}}{{balanceServicePort}}"
							],
							"path": [
								"api",
								"v1",
								"balance",
								"topUp"
							]
						}
					},
					"response": []
				},
				{
					"name": "writeOffFromBalance",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"pm.sendRequest(pm.environment.get(\"host\") + pm.environment.get(\"balanceServicePort\") + \"/api/v1/balance/canWriteOff?score=29&userID=\" + pm.environment.get(\"currentBalanceUserID\"), function (err, response) {",
									"    let res = response.json();",
									"    console.log(response.status);",
									"    pm.test('It should be possible to write off 29 score', function () {",
									"        pm.expect(response.status).to.eql(\"OK\");",
									"        pm.expect(res.result).to.eql(true);",
									"    });",
									"});",
									"pm.sendRequest(pm.environment.get(\"host\") + pm.environment.get(\"balanceServicePort\") + \"/api/v1/balance/canWriteOff?score=30&userID=\" + pm.environment.get(\"currentBalanceUserID\"), function (err, response) {",
									"    let res = response.json();",
									"    console.log(response.status);",
									"    pm.test('It should be impossible to write off 30 score', function () {",
									"        pm.expect(response.status).to.eql(\"OK\");",
									"        pm.expect(res.result).to.eql(false);",
									"    });",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"userID\": \"{{currentBalanceUserID}}\",\n    \"score\": 71\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}{{balanceServicePort}}/api/v1/balance/writeOff",
							"host": [
								"{{host}}{{balanceServicePort}}"
							],
							"path": [
								"api",
								"v1",
								"balance",
								"writeOff"
							]
						}
					},
					"response": []
				},
				{
					"name": "removeBalance",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"userID\": \"{{currentBalanceUserID}}\"}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}{{balanceServicePort}}/api/v1/balance/remove",
							"host": [
								"{{host}}{{balanceServicePort}}"
							],
							"path": [
								"api",
								"v1",
								"balance",
								"remove"
							]
						}
					},
					"response": []
				},
				{
					"name": "CanWriteOff",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{host}}{{balanceServicePort}}/api/v1/balance/canWriteOff?userID=e2d447b9-bff9-4d6b-b395-d363ac89c8d1&score=20",
							"host": [
								"{{host}}{{balanceServicePort}}"
							],
							"path": [
								"api",
								"v1",
								"balance",
								"canWriteOff"
							],
							"query": [
								{
									"key": "userID",
									"value": "e2d447b9-bff9-4d6b-b395-d363ac89c8d1"
								},
								{
									"key": "score",
									"value": "20"
								}
							]
						}
					},
					"response": []
				}
			]
		}
	]
}